function x(d){return{elementid:d.elementId,labelsId:d.labelsId,selectedLabel:"",selectedColor:"",labelList:new Map,init:function(){console.log(this.elementid),document.getElementById(this.elementid).addEventListener("mouseup",this.watchfield),document.getElementById(this.labelsId).addEventListener("mouseup",this.watchfield),this.updatedLabel(),this.generateUUID(),this.contextmenu()},watchfield:function(s){var t=this,l=window.getSelection(),a=l.toString();if(a!==""){for(var e=l.getRangeAt(0);/^\s/.test(e.startContainer.textContent[e.startOffset]);)e.setStart(e.startContainer,e.startOffset+1);for(;/\s$/.test(e.endContainer.textContent[e.endOffset-1]);)e.setEnd(e.endContainer,e.endOffset-1);var i=e.commonAncestorContainer,f=i.nodeType===Node.ELEMENT_NODE&&i.classList.contains("selected-label"),r=!1;if(e.startContainer!==e.endContainer){for(var v=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:function(u){return u.classList&&u.classList.contains("selected-label")?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),c;c=v.nextNode();)if(e.intersectsNode(c)){r=!0;break}}if(!f&&!r){var m=e.startOffset,L=e.endOffset,C=t.generateUUID();t.labelList.set(C,{text:a,start:m,end:L,label:t.selectedLabel,color:t.selectedColor}),console.log(t.labelList)}var n=document.createElement("span");n.textContent=a,n.style.color=t.selectedColor,n.classList.add("selected-label"),n.classList.add("tooltip");var b=t.generateUUID();n.dataset.uuid=b;var o=document.createElement("span");o.textContent=t.selectedLabel,o.classList.add("tooltiptext"),n.appendChild(o),e.deleteContents(),e.insertNode(n),l.removeAllRanges()}},updatedLabel:function(){var s=this;window.updateLabel=function(t,l){s.selectedLabel=t,s.selectedColor=l}},generateUUID:function(){return"xxx".replace(/[xy]/g,function(s){var t=Math.random()*16|0,l=s==="x"?t:t&3|8;return l.toString(16)})},contextmenu:function(){var s=this;document.addEventListener("contextmenu",function(t){var l=t.target;if(l.classList.contains("selected-label")){t.preventDefault();var a=l.querySelector(".tooltiptext"),e=l.dataset.uuid;a&&a.remove(),l.style.color="",l.classList.remove("tooltip","selected-label"),s.labelList.delete(e);var i=document.createTextNode(l.textContent);l.parentNode.replaceChild(i,l)}})}}}export{x as default};
